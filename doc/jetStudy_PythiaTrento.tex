\documentclass[11pt]{article}
\pagestyle{myheadings}
\markright{Pythia-Trento Jet Study and Date - \today}
\usepackage{graphicx}
\usepackage{color}
\usepackage{enumitem}
\usepackage{hyperref}
\usepackage{amsmath}
\usepackage{pdfpages}
\usepackage[nottoc,numbib]{tocbibind} %inserts References in table of contents
\usepackage[sort&compress]{natbib}
%
\textwidth 7.0in
\textheight 9in
%\itemsep 0pt
\parsep 5pt
\parindent 10pt
\parskip 5pt
\hoffset -1.in
\voffset -0.5in

\begin{document}

%
% Useful command to condense itemize lists
%
\newcommand{\zapspace}{\topsep=1pt\partopsep=1pt\itemsep=1pt\parskip=2pt}
\newcommand{\trento}{\mbox{T$_{\rm R}$ENTo}}

\begin{center}
{\Large \bf Pythia Jet Finding Study with Trento Backgrounds\\}
\bigskip
Joseph Simpson and Ron Soltz
\end{center}

\begin{abstract}
We present results applying the Pythia SlowJet Finder to Pythia generated QCD and QED hard processes in the presence of simulated heavy ion backgrounds.  The hard process events are generated with Pythia version~8.219 for $\sqrt{s}$200~GeV proton-proton collisions and the backgrounds are generated by the Reduced Thickness Event-by-event Nuclear Topology model \trento\ for Au-Au collisions with a nucleon-nucleon cross-section of 4.23~fm$^2$.  The \trento\ model is used to determine the initial entropy and ellipticity from which the the total charged particle multiplicity and elliptic flow are determined.  We report results in the form of event displays, total $p_T$ distributions, and fragmentation distributions for SlowJet applied to Pythia events with and without the simulated heavy ion backgrounds.
\end{abstract}

\tableofcontents

\newpage 

\section{Introduction}
\subsection*{Motivation}

The study of jet-quenching in heavy ion collisions, how jets lose energy as they evolve within the quark-gluon plasma (QGP) is one of the most important topics remaining in the quest to understand the detailed properties of the QGP.  However, the task of reconstructing jets within a high multiplicity heavy ion background can be difficult.  Fluctuations in the background can be falsely reconstructed as jets, and true jets that lose energy in the plasma can easily be buried within the backgrounds.  The purpose of this study is to develop a set of simple tools to study jets within an environment that simulates the basic elements of a heavy ion background with thermal particle production and radial and elliptic flow, and then to use these tools to create visual images of the jets and quantitative distributions of jet properties in a fluctuating heavy ion background.  For this study, it is assumed that the identity, mass, and momenta of all produced particles are precisely known.  We do not attempt to include any detector effects.

\subsection*{Software Framework}

For this study we work with the Pythia 8.219 Python package, which can be called from Python 2.7.  We use the SlowJet routines that are included in the Pythia installation.  SlowJet provides an {\it anti-k$T$} jet-finding algorithm that produces identical results to FastJet, but does not run as quickly.  Most of the analysis is done using numpy and matplotlib.pyplot packages.  The \trento\ version 1.3 code is run as a stand-alone program.  \trento\ outputs are saved to text files and read from Python scripts, although it is also possible for it to be called directly from within Python.  Unless stated otherwise, all \trento\ backgrounds are for minimum bias distributions.  Additional details on using these packages are given in the descriptions below.

\section{Running Pythia}
%
%Describe pythia settings, show lego plot of jet events, for QCD and QED
%Show distribution of jet pT distributions for QCD and QED
%
Pythia allows users to set beam CM energy (eCM). By default Pythia sets eCM to 14 TeV, the default for all our programs is 200 GeV .  Initial QCD or QED hard scattering processes may be turned on or off. Pythia also allows restrictions to be set on the transverse momentum produced by hard scattering (pTHat or jet pT). For our programs the jet pT range is typically 20-25 GeV. Figure 1 shows the distribution of jet pT for both various QCD and various QED processes restricted to the range of 20-50 GeV. The upper histogram of figure 1 shows the four most common QCD hard processes produced by Pythia. The different processes are shown in the legend. Gluons are represented by "g", quarks (uds) are represented by "q", and anti-quarks (uds) are represented by "q(bar)." There are also other hard processes, such as those that involve heavy quarks, but they occur so infrequently that they are not included. The lower histogram shows all five of the QED hard processes, however only two of the processes occur frequently. For these processes photons are represented by "gamma," and fermions participating in electroweak interactions are represented by "f" and "f(bar)."

Figure 2 shows two lego plots, one for a QCD event and one for a QED event. These plots demonstrate how our programs are able to display each Pythia event. Each particle that is produced from a Pythia event is binned in a 2 dimensional histogram depending on its pseudo-rapidity ($\eta$) and azimuthal angle ($\phi$). The histogram bins are weighted by transverse energy (eT). In both plots it is easy to identify the jets produced by the Pythia events. For the QED plot it is important to note that one of the jets is produced by only a single photon. 

\begin{figure}[h]
\begin{center}
\includegraphics[width=0.8\textwidth]{pT_pythiaEvents.pdf}
\label{fig_label}
\caption{Distribution of jet pT for QCD and QED processes.  Figure created with [python pT\_pythiaEvents.py -m 20000]}
\end{center}
\end{figure}

\begin{figure}[h]
\begin{center}
\includegraphics[width=0.49\textwidth]{2d_hist_jetplot.png}
\includegraphics[width=0.49\textwidth]{2d_hist_jetplot2.png}
\label{fig_label}
\caption{Pythia event display for a QCD event, shown to the left, and a QED event shown to the right.  Left figure created with [python 2d\_hist\_jetplot\_wcol.py -o -b 30]. Right figure created with [python 2d\_hist\_jetplot\_wcol.py -o -c -q -b 30]}
\end{center}
\end{figure}

\section{Adding Trento Backgrounds}
%
% Describe how Trento is run, list parameters.
% Describe how we convert Trento output into particle number
% Explain how we generate pT, eta, and phi.
% Explain we add radial flow and elliptic flow from epsilon_2 variable.
%
\trento\ allows users to input several physical options in order to create realistic heavy ion collision backgrounds. These options include two projectiles, number of events, reduced-thickness, fluctuation, nucleon-width, cross-section, and a normalization factor. For each data set,  we used non-deformed gold (Au) nuclei with 197 nucleons each. We produced 100,000 events for several different cross-sections. All other physical options were left to their default settings: reduced-thickness = 0, fluctuation = 1, nucleon-width = 0.5 fm, and normalization = 1. Different cross-sections correspond to different CM beam energies per nucleon pair. The cross-sections (in units of fm$^2$) that we used to simulate the different beam energies are as follows: 4.23 for 200 GeV, 3.96 for 130 GeV, 3.60 for 62.4 GeV, 3.43 for 39 GeV, 3.32 for 27 GeV, 3.25 for 19.6 GeV, 3.20 for 15.0 GeV, and 3.12 for 7.7 GeV. \trento\ reads in the options and produces a text file listing several event properties for each event: event number, impact parameter, number of participants, initial entropy, and properties of flow. The produced \trento\ text files were then imported into our programs as an array of event data.

To use the \trento\ data as we intended we had to produce accurate Au-Au multiplicities for the various beam energies. To do this we fit the \trento\ data to PHENIX data. We created a histogram for the number of participants in each \trento\ event and weighted the bins by the initial entropy. We then scaled the \trento\ data at each energy by a constant to fit it to the PHENIX data of charged multiplicity vs. number of participants. Using the constants from the fit at each energy allowed us to create multiplicity values from the initial entropy values.

Using the \trento\ multiplicity values we now knew how many background particles to create for each \trento\ event. To generate values of transverse momentum (pT), pseudo-rapidity ($\eta$), and azimuthal angle ($\phi$) for each particle we used the numpy random number generator. For $\phi$  and $\eta$ we created flat distributions between -$\pi$ to $\pi$ and -2 to 2, and for pT we sampled from a Gaussian deviate, which is equivalent to a thermal Boltzmann distribution. We also included radial and elliptic flow into our background distributions by using the $\epsilon_2$ variable from the \trento\ data. First we calculated the initial transverse rapidity (yT) and then applied flow as an additive boost. The scaling parameter for radial flow ($\rho_0$) that we used was 0.85 from Retiere and Lisa, PRC70.044907 (2004), table 2.  The scaling parameter for elliptic flow ($\rho_2$) was 0.15 from Alver and Roland, PRC81,054905 (2010), fig 4. Again using the numpy random number generator we created a normalized radial distance ($\rho$). After applying flow, yT was converted back to pT. The mass used for these calculations was chosen randomly from one of nine different particles that were included in the produced background. These particles consisted of pions, kaons, protons, and neutrons, as well as the anti particle counterparts. Figure 3 shows the background display produced from a \trento\ event. Again each particle that is produced is binned in a 2 dimensional histogram depending on its pseudo-rapidity ($\eta$) and azimuthal angle ($\phi$). For this plot the histogram bins are weighted by pT. There are no jets produced within the \trento\ background.

\begin{figure}[h]
\begin{center}
\includegraphics[width=0.49\textwidth]{2d_hist_trento.png}
\includegraphics[width=0.49\textwidth]{2d_hist_trento2.png}
\label{fig_label}
\caption{Trento event display (no jets).  Both plots created with [python 2d\_hist\_trento.py -b 30]}
\end{center}
\end{figure}

\section{Working with SlowJet Finder}
%
% Describe SlowJet Finder algorithm and input parameters.
% Show examples of SlowJet Finder on Pythia only.
% Show example of SlowJet Finder on Pythia plus Trento.
%
The SlowJet jet finder takes several input parameters that affect how it searches for jets. These parameters are power, radius, minimum jet pT (pTjetMin), etaMax, select, and mass set. Power determines which jet finding algorithm to use. For our programs we set power to -1, this corresponds to the anti-kT algorithm. Other possible algorithms for SlowJet are the Cambridge/Aachen algorithm and the kT algorithm. Radius is crudely related to the radius of the jet cone in (y,$\phi$) space. In most of our programs radius is set to 0.7 by default. pTjetMin is the minimum pT that a cluster must have to become a jet. etaMax is the maximum +/- pseudo-rapidity that the detector is assumed to cover. For our programs etaMax is always set to 2. Select determines which particles are analyzed by SlowJet. For our programs select is always set to 2 which corresponds to all observable final-state particles. Mass set determines the masses assumed for the particles analyzed by SlowJet. There are three mass set options: 0 for all massless, 1 for photons are massless while all others are assigned the mass of charged pions, and 2 for all given their correct masses. For our programs mass set is set to either 1 or 2.

Figures 4, 5, and 6 demonstrate how well SlowJet is able to function in Pythia events with varying amounts of heavy ion background. All three figures use the same familiar event display that was shown in figures 2 and 3 and use the standard SlowJet settings discussed above. In these three figures the color scheme is that Pythia particles that are identified as jets are colored red while all other Pythia particles are colored blue, \trento\ particles that are identified as jets are colored yellow while other \trento\ particles are colored sky blue. Figure 4 is a Pythia event with no heavy ion background. In this case SlowJet correctly identifies both jets. Figure 5 is a greater test for SlowJet because now a low multiplicity \trento\ background is introduced. In this event SlowJet is still able to correctly identify the two jets, however a few background particles, shown in yellow, are also lumped in with the jets. Figure 6, which now includes a high multiplicity heavy ion background, shows how SlowJet can become confused. In this case there are many \trento\ particles identified as jets, these are shown in yellow. The true jets become lost in the background and SlowJet fails.

\begin{figure}[h]
\begin{center}
\includegraphics[width=0.8\textwidth]{2d_hist_jetplot_wcol.png}
\label{fig_label}
\caption{Event display for Pythia with SlowJet Finder, no heavy ion background.  Particles identified as being a part of a jet are colored red, all other particles are colored blue. Figure created with [python 2d\_hist\_jetplot\_wcol.py -b 30]}
\end{center}
\end{figure}

\begin{figure}[h]
\begin{center}
\includegraphics[width=0.49\textwidth]{pythia_slowjet_trento_hist1.png}
\includegraphics[width=0.49\textwidth]{pythia_slowjet_trento_hist2.png}
\label{fig_label}
\caption{Event display for Pythia+Trento with SlowJet Finder, low multiplicity heavy ion background. The color scheme is that Pythia particles that are identified as jets are colored red, other Pythia particles are colored blue, \trento\ particles that are identified as jets are colored yellow, and other \trento\ particles are colored sky blue. Figure created with [python pythia\_slowjet\_trento\_hist.py -b 30 -s 1]}
\end{center}
\end{figure}

\section{Studying Jets}
%
% Define formula for fragmentation function.
% Explain methodology for tracing particles in 
%

\begin{figure}[h]
\begin{center}
\includegraphics[width=0.9\textwidth]{compare_xi.pdf}
\label{fig_label}
\caption{Fragmentation Function (Xi) distributions for true and reconstructed QCD and QED jets, with and without trento backgrounds.  Figure created with [python compare\_xi.py]}
\end{center}
\end{figure}

\appendix{Listing of Python Scripts}
%
% Provide descriptions for all python scripts, similar to README file.
%

\end{document}