\documentclass[11pt]{article}
\pagestyle{myheadings}
\markright{Pythia-Trento Jet Study and Date - \today}
\usepackage{graphicx}
\usepackage{color}
\usepackage{enumitem}
\usepackage{hyperref}
\usepackage{amsmath}
\usepackage{pdfpages}
%\usepackage[nottoc,numbib]{tocbibind} %inserts References in table of contents
%\usepackage[sort&compress]{natbib}
%
\textwidth 6.5in
\textheight 8.5in
%\itemsep 0pt
\parsep 5pt
\parindent 10pt
\parskip 5pt
\hoffset -0.75in
\voffset -0.25in

\begin{document}

%
% Useful command to condense itemize lists
%
\newcommand{\zapspace}{\topsep=1pt\partopsep=1pt\itemsep=1pt\parskip=2pt}
\newcommand{\trento}{\mbox{T$_{\rm R}$ENTo}}

\begin{center}
{\Large \bf Pythia Jet Finding Study with Trento Backgrounds\\}
\bigskip
Joseph Simpson and Ron Soltz
\end{center}

\begin{abstract}
We present results applying the Pythia SlowJet Finder to Pythia generated QCD and QED hard processes in the presence of simulated heavy ion backgrounds.  The hard process events are generated with Pythia version~8.219 for $\sqrt{s_{NN}}$=200~GeV proton-proton collisions and the backgrounds are generated by the Reduced Thickness Event-by-event Nuclear Topology model \trento\ for Au-Au collisions with a nucleon-nucleon cross-section of 4.23~fm$^2$.  The \trento\ model is used to calculate the initial entropy and ellipticity from which the total charged particle multiplicity and elliptic flow are determined.  We report results in the form of event displays, total $p_T$ distributions, and fragmentation distributions for SlowJet applied to Pythia events with and without the simulated heavy ion backgrounds.
\end{abstract}

\tableofcontents

\newpage 

\section{Introduction}
\subsection*{Motivation}

The study of jet-quenching in heavy ion collisions, how jets lose energy as they evolve within the quark-gluon plasma (QGP) is one of the most important topics remaining in the quest to understand the detailed properties of the QGP.  However, the task of reconstructing jets within a high multiplicity heavy ion background is a challenge for RHIC energies.  Fluctuations in the background can be falsely reconstructed as jets, and true jets that lose energy in the plasma can easily be buried within the backgrounds.  The purpose of this study is to develop a set of simple tools to study jets within an environment that simulates the basic elements of a heavy ion background with thermal particle production and radial and elliptic flow, and then to use these tools to create visual images of the jets and quantitative distributions of jet properties in a fluctuating heavy ion background.  For this study, it is assumed that the identity, mass, and momenta of all produced particles are precisely known.  We do not attempt to include any detector effects in our simulation.

\subsection*{Software Framework}

For this study we work with the Pythia 8.219 Python package, which can be called from Python (using v2.7), and we use the SlowJet routines that are included in the Pythia installation.  SlowJet provides an option to run an anti-$k_T$ algorithm that produces identical results to FastJet, but does not run as quickly.  Most of the analysis is done using numpy and matplotlib.pyplot packages.  We use \trento\ version 1.3 code to create heavy ion backgrounds. The \trento\ code is run as a stand-alone program.  \trento\ outputs are saved to text files and read from Python scripts, although it is also possible for it to be called directly from within Python.  Unless stated otherwise, all \trento\ backgrounds are for minimum bias distributions.  Additional details on using these packages are given in the descriptions below.

\section{Running Pythia}
%
%Describe pythia settings, show lego plot of jet events, for QCD and QED
%Show distribution of jet pT distributions for QCD and QED
%
Pythia allows users to set the beam center-of-mass energy ($E_{CM}$). By default Pythia sets $E_{CM}$ to 14 TeV, the default for all our programs is 200 GeV.  Initial QCD or QED hard scattering processes may be turned on or off. Pythia also allows restrictions to be set on the transverse momentum produced by hard scattering ($p_{THat}$ or jet $p_T$). For our programs the jet $p_T$ range is typically 20-25 GeV. Figure~\ref{fig_pythia_pT_process} shows the distribution of jet $p_T$ for various QCD and QED processes for jets above 20 GeV. The upper histogram of Figure~\ref{fig_pythia_pT_process} shows the four most common QCD hard processes produced by Pythia. The different processes are shown in the legend. Gluons are represented by "g", quarks (uds) are represented by "q", and anti-quarks ($\overline{uds}$) are represented by "q(bar)." There are also other hard processes, such as those that involve heavy quarks, but they occur so infrequently that they are not included. The lower histogram shows all five of the QED hard processes, however only two of the processes occur frequently. For these processes photons are represented by "gamma," and fermions participating in electroweak interactions are represented by "f" and "f(bar)."

Figure~\ref{fig_2d_pythia_slowjet} shows two lego plots, one for a QCD event and one for a QED event. These plots demonstrate how our programs are able to display each Pythia event. Each particle that is produced from a Pythia event is binned in a 2 dimensional histogram depending on its pseudo-rapidity ($\eta$) and azimuthal angle ($\phi$). The histogram bins are weighted by transverse energy ($E_T$). In both plots it is easy to identify the jets produced by the Pythia events. For the QED plot it is important to note that one of the jets is produced by only a single photon. 

\begin{figure}[h]
\begin{center}
\includegraphics[width=0.8\textwidth]{pythia_pT_process.pdf}
\caption{Distribution of jet pT for QCD and QED processes for 20,000 events.  Figure created with [python pythia\_pT\_process.py -m 20000]}
\label{fig_pythia_pT_process}
\end{center}
\end{figure}

\begin{figure}[h]
\begin{center}
\includegraphics[width=0.49\textwidth]{2d_pythia_slowjet1.png}
\includegraphics[width=0.49\textwidth]{2d_pythia_slowjet2.png}
\caption{Pythia event display for a QCD event, shown to the left, and a QED event shown to the right.  Left figure created with [python 2d\_pythia\_slowjet.py -o -b 30]. Right figure created with [python 2d\_pythia\_slowjet.py -o -c -q -b 30]}
\label{fig_2d_pythia_slowjet}
\end{center}
\end{figure}

\section{Adding Trento Backgrounds}
%
% Describe how Trento is run, list parameters.
% Describe how we convert Trento output into particle number
% Explain how we generate pT, eta, and phi.
% Explain we add radial flow and elliptic flow from epsilon_2 variable.
%
\trento\ allows users to input several physical options in order to generate initial states from which we are able to derive realistic heavy ion collision backgrounds. These options include two projectiles, number of events, reduced-thickness, fluctuation, nucleon-width, cross-section, and a normalization factor. For each data set,  we used non-deformed gold (Au) nuclei with 197 nucleons each. We produced 100,000 events for several different cross-sections. All other physical options were left to their default settings: reduced-thickness = 0, fluctuation = 1, nucleon-width = 0.5 fm, and normalization = 1. Different cross-sections correspond to different beam $E_{CM}$ per nucleon pair. The cross-sections (in units of fm$^2$) that we used to simulate the different beam energies are shown in Table~\ref{tab_phenix_trento}.  An important note is that the corresponding cross-section for 14.5 GeV was shown corresponding to 15.0 GeV for the PHENIX data, however we assumed this be a typo. \trento\ reads in the options and produces a text file listing several event properties for each event: event number, impact parameter, number of participants, initial entropy, and properties of flow. The produced \trento\ text files were then imported into our programs as an array of event data.
%
\begin{table}[th]
\begin{center}
\caption{Cross Sections and Scaling Constants}
\label{tab_phenix_trento}
\begin{tabular}{|c|l|l|}
\hline
$E_{CM}$(GeV) & $\sigma_{nn}$(fm$^2$) & Scaling Constant \\
\hline
200 & 4.23 & 4.66 \\
\hline
130 & 3.96 & 3.97 \\
\hline
62.4 & 3.60 & 3.13 \\
\hline
39 & 3.43 & 2.55 \\
\hline
27 & 3.32 & 2.16 \\
\hline
19.6 & 3.25 & 1.95 \\
\hline
14.5 & 3.20 & 1.65 \\
\hline
7.7 & 3.12 & 1.27 \\
\hline
\end{tabular}
\end{center}
\end{table}

To use the \trento\ data as we intended we had to produce accurate Au-Au multiplicities for the various beam energies. To do this we fit the \trento\ data to PHENIX data as shown in Figure~\ref{fig_phenix_trento_comp}.  We created a histogram for the number of participants in each \trento\ event and weighted the bins by the initial entropy. We then scaled the \trento\ data at each energy by a constant to fit it to the PHENIX data of charged multiplicity vs. number of participants. The \trento\ data points are the open shapes that and are connected by lines. Using the scaling constants from the fit at each energy allowed us to create multiplicity values from the initial entropy values. The scaling constants that we used are shown in Table~\ref{tab_phenix_trento}.

Using the \trento\ multiplicity values we generated background particles for each \trento\ event. To generate values of transverse momentum ($p_T$), pseudo-rapidity ($\eta$), and azimuthal angle ($\phi$) for each particle we used the numpy random number generator. For $\phi$  and $\eta$ we created flat distributions between -$\pi$ to $\pi$ and -2 to 2, and for $p_T$ we sampled from a Gaussian deviate, which is equivalent to a thermal Boltzmann distribution. We also included radial and elliptic flow into our background distributions by using the $\epsilon_2$ variable from the \trento\ data. First we calculated the initial transverse rapidity ($y_T$) and then applied flow as an additive boost. 
\[y_{Boost} = \rho_0 r+ \rho_2  \epsilon_2  cos(2\phi)\]
The scaling parameter for radial flow ($\rho_0$) that we used was 0.85, taken from Table 2 of~\cite{Retiere:2004hn}.  The scaling parameter for elliptic flow ($\rho_2$) was 0.15 from Figure 4 of~\cite{Alver:2010do}.  Using the numpy random number generator we created a normalized radial distance ($r$). After applying flow, $y_T$ was converted back to $p_T$. The mass used for these calculations was chosen randomly from one of nine different particles that were included in the produced background. These particles consisted of pions, kaons, protons, and neutrons, as well as their anti particle counterparts. Figure~\ref{fig_2d_trento} shows the background display produced from \trento\ events. Again each particle that is produced is binned in a 2 dimensional histogram in ($\eta$,$\phi$) space. For this plot the histogram bins are weighted by $p_T$. There are no jets produced within the \trento\ background.

\begin{figure}[h]
\begin{center}
\includegraphics[width=0.49\textwidth]{phenix_trento_comp.pdf}
\caption{Fit of \trento\ data to PHENIX data. Figure created with [python phenix\_trento\_comp.py]}
\label{fig_phenix_trento_comp}
\end{center}
\end{figure}

\begin{figure}[h]
\begin{center}
\includegraphics[width=0.49\textwidth]{2d_trento1.png}
\includegraphics[width=0.49\textwidth]{2d_trento2.png}
\caption{\trento\ event display (no jets). High multiplicity is shown on the right and lower multiplicity on the left. Both plots created with [python 2d\_trento.py -b 30]}
\label{fig_2d_trento}
\end{center}
\end{figure}

\section{Working with SlowJet Finder}
%
% Describe SlowJet Finder algorithm and input parameters.
% Show examples of SlowJet Finder on Pythia only.
% Show example of SlowJet Finder on Pythia plus Trento.
%
The SlowJet jet finder takes several input parameters that affect how it searches for jets. These parameters are $power$, $radius$, $p_TjetMin$, $etaMax$, $select$, and $massSet$. The $power$ parameter determines which jet finding algorithm to use. For our programs we set $power$ to -1, this corresponds to the {\it anti-k$T$} algorithm. Other possible algorithms for SlowJet are the Cambridge/Aachen algorithm and the $kT$ algorithm. The $radius$ parameter is crudely related to the radius of the jet cone in ($y$,$\phi$) space. In most of our programs $radius$ is set to 0.7 by default. The $p_TjetMin$ parameter is the minimum $p_T$ that a cluster must have to become a jet. Our values for $p_TjetMin$ are normally set to 10 or 15 GeV. The $etaMax$ parameter is the maximum +/- pseudo-rapidity that the detector is assumed to cover. For our programs $etaMax$ is always set to 2. The $select$ parameter determines which particles are analyzed by SlowJet. For our programs $select$ is always set to 2 which corresponds to all observable final-state particles. The $massSet$ parameter determines the masses assumed for the particles analyzed by SlowJet. There are three $massSet$ options: 0 for all massless, 1 for photons are massless while all others are assigned the mass of charged pions, and 2 for all given their correct masses. For our programs $massSet$ is set to 2, with an option for it to be set to 1. The $radius$ and $p_TjetMin$ parameters are most often changed while we examine jets.

The {\it anti-k$T$} algorithm functions by finding the hardest particle in an event and grouping all soft particles within a certain radius into a cluster. This is then repeated for the next hard particle and so on. If two hard particles are very close they will be grouped into the same cluster. If the jet cones of two hard particles are close enough that they may overlap, the hard particle with the higher $p_T$ will have a complete cone that cuts into the cone of the other. If the $p_T$ of the two hard particles is very close then the boundary between the cones will be a straight line. In this way the {\it anti-k$T$} algorithm is resilient with respect to soft radiation but flexible with respect to hard radiation.

Figure~\ref{fig_2d_pythia_slowjet_truejet} and Figure~\ref{fig_2d_pythia_trento_slowjet_truejet} demonstrate how well SlowJet is able to function in Pythia events with varying amounts of heavy ion background. Both figures use the same familiar event display that was shown in Figure~\ref{fig_2d_pythia_slowjet} and Figure~\ref{fig_2d_trento} and use the standard SlowJet settings discussed above. In these figures the color scheme is that Pythia jets that are identified correctly by SlowJet are colored green, particles mistakenly identified as SlowJet jets are colored yellow,  Pythia jets that are missed by SlowJet are colored red, and all other background particles are colored blue. Figure~\ref{fig_2d_pythia_slowjet_truejet} shows two Pythia events with no heavy ion background. In the event shown on the left SlowJet correctly identifies both jets. However, in the event on the right, the second jet is too diffuse and SlowJet does not identify it as a jet. Figure~\ref{fig_2d_pythia_trento_slowjet_truejet} is a greater test for SlowJet because now a \trento\ background is introduced. In the low \trento\ multiplicity event, SlowJet is still able to correctly identify the two jets, however a few background particles, shown in yellow, are also lumped in with the jets.  In the high \trento\ multiplicity event SlowJet becomes confused. In this case there are many \trento\ particles identified as jets, those shown in yellow. The true jets become lost in the background and SlowJet fails.

All the bar plots in Figure~\ref{fig_2d_pythia_slowjet_truejet} and Figure~\ref{fig_2d_pythia_trento_slowjet_truejet} are created in a way so that bars are stacked on top of each other if two different color bars share the same bin. The order in which the bars are stacked is that the blue bars corresponding to background not mistaken as jets goes on the bottom. The red bars associated with true jet particles not identified as jets are stacked next. Then the yellow bars associated with falsely identified jets are stacked. Correctly identified jets, shown in green, are then stacked on the very top. This order of stacking the bars is the most useful when displaying very congested events because it is easy to see how SlowJet performed.

\begin{figure}[h]
\begin{center}
\includegraphics[width=0.49\textwidth]{2d_pythia_slowjet_truejet1.png}
\includegraphics[width=0.49\textwidth]{2d_pythia_slowjet_truejet2.png}
\caption{Event display for Pythia with SlowJet Finder, no heavy ion background.  SlowJet succeeds on the left but struggles on the right. Both plots created with [python 2d\_pythia\_slowjet\_truejet.py]}
\label{fig_2d_pythia_slowjet_truejet}
\end{center}
\end{figure}

\begin{figure}[h]
\begin{center}
\includegraphics[width=0.49\textwidth]{2d_pythia_trento_slowjet_truejet1.png}
\includegraphics[width=0.49\textwidth]{2d_pythia_trento_slowjet_truejet2.png}
\caption{Event display for Pythia+Trento with SlowJet Finder. Low multiplicity \trento\ background shown to the left and high multiplicity \trento\ background shown to the right. Correctly identified jets are colored green, mistakenly identified jets are colored yellow, jets that SlowJet missed are colored red, and all background particles are colored blue. Both plots created with [python 2d\_pythia\_trento\_slowjet\_truejet.py]}
\label{fig_2d_pythia_trento_slowjet_truejet}
\end{center}
\end{figure}

\section{Studying Jets}
%
% Define formula for fragmentation function.
% Explain methodology for tracing particles in jets
%
To study jets and explore the different parameters of SlowJet we first focused on the SlowJet parameters of $radius$ and $p_TjetMin$. One of our programs examined how many jets were identified in Pythia events with \trento\ backgrounds. Ideally SlowJet should identify 2 jets for each Pythia event. We found that when $p_TjetMin$ was set low and $radius$ was set high, far too many jets would be identified on average. However, if $p_TjetMin$ was set high and $radius$ set low, very few jets would be identified. In the \trento\ backgrounds it is difficult to raise the requirements for clusters to be identified as jets while still being able to identify all Pythia jets. The plots produced by this program are shown in Figure~\ref{fig_slowjet_pTmin_radius}. Another program restricted the $p_T$ of Pythia jets to 20-25 GeV and set $p_TjetMin$ to 15 GeV. The $radius$ parameter was then varied to see if the identified jets would be in the correct $p_T$ range. We found similar results. Increasing $radius$ to values as high as 0.8 caused the peak of identified jets to be within the proper $p_T$ range but also allowed many jets above the range to be identified as well. Decreasing $radius$ to values as low as 0.3 caused the peak of identified jets to fall below the proper $p_T$ range but reduced the number of jets that were identified above the range.

Figure~\ref{fig_slowJet_vs_pTHat} shows the effect on the SlowJet finder of adding \trento\ background to Pythia events. Both plots in Figure~\ref{fig_slowJet_vs_pTHat} use SlowJet with our default settings. In the plot on the left SlowJet is able to calculate the correct jet $p_T$ on average. However, in the plot on the right with \trento\ background included, the SlowJet $p_T$ values are higher than they should be. This occurs because SlowJet is incorrectly identifying \trento\ background particles as parts of jets.

Our next focus was on the fragmentation function value ($\xi$) for particles within both SlowJet jets and true jets. $\xi$ provides information on how the energy is distributed along the jet. To calculate $\xi$ we used the following formula:
\[\xi = ln((\vec{p_{jet}} \cdot \vec{p_{jet}})/(\vec{p_{jet}} \cdot \vec{p_{prt}}))\]
In Figure~\ref{fig_xi_slowjet_truejet}, $\xi$ is calculated for both QCD and QED events with no \trento\ data on the left and with \trento\ data on the right. $\xi$ is calculated for SlowJet jets with $radius$ set at 0.3, 0.5, and 0.7 in all four plots. In the plots it is noticeable that as $radius$ is decreased the peak of $\xi$ values for reconstructed jets is reduced. This occurs because particles with higher $\xi$ values are farther away from the center of the jet cone. As $radius$ is decreased particles on the edge of the jet cone are no longer included in the reconstructed jets. True jets consist of all particles that are ancestors of the initial hard scattering in each Pythia event. These particles were identified by tracing the daughters of each particle starting with the two initial particles that participated in the hard process and ending when only final state particles remain.

\begin{figure}[h]
\begin{center}
\includegraphics[width=0.49\textwidth]{slowjet_pTmin_radius1.pdf}
\includegraphics[width=0.49\textwidth]{slowjet_pTmin_radius2.pdf}
\caption{The 2 dimensional histogram on the left shows the average number of jets found by SlowJet in Pythia events with \trento\ background. The plots on the right are 1 dimensional scatter plots that explore the optimization of each parameter individually. All plots created with [python slowjet\_pTmin\_radius.py]}
\label{fig_slowjet_pTmin_radius}
\end{center}
\end{figure}

\begin{figure}[h]
\begin{center}
\includegraphics[width=0.49\textwidth]{slowpT_vs_pThat_pythia.pdf}
\includegraphics[width=0.49\textwidth]{slowpT_vs_pThat_pythia_trento.pdf}
\caption{The left plot shows SlowJet $p_T$ vs. the true $p_T$ of Pythia jets without \trento\ background. The right plot has \trento\ background included. The left plot was created with [python slowJetpT\_vs\_pTHat.py -i -u 10000]. The right plot was created with [python slowJetpT\_vs\_pTHat.py -t -i -u 10000].}
\label{fig_slowJet_vs_pTHat}
\end{center}
\end{figure}

\begin{figure}[h]
\begin{center}
\includegraphics[width=0.9\textwidth]{xi_slowjet_truejet.pdf}
\caption{Fragmentation function value ($\xi$) distributions for true and reconstructed QCD and QED jets, with and without trento backgrounds.  Figure created with [python xi\_slowjet\_truejet.py]}
\label{fig_xi_slowjet_truejet}
\end{center}
\end{figure}

\appendix

\section{Listing of Python Scripts}
\begin{description}
\item[2d\_pythia\_slowjet.py] Displays Pythia events in ($\eta$,$\phi$) space, SlowJet jets are colored red
\item[2d\_trento.py] Displays \trento\ backgrounds in ($\eta$,$\phi$) space
\item[2d\_pythia\_slowjet\_truejet.py] Displays Pythia events in ($\eta$,$\phi$) space, SlowJet jets are compared to true jets
\item[2d\_trento\_slowjet.py] Displays \trento\ background in ($\eta$,$\phi$) space, SlowJet identified jets are colored red
\item[2d\_pythia\_trento\_slowjet.py] Displays Pythia events with \trento\ backgrounds in ($\eta$,$\phi$) space, bars are colored to show SlowJet performance
\item[2d\_pythia\_trento\_slowjet\_truejet.py] Displays Pythia events with \trento\ backgrounds in ($\eta$,$\phi$) space, SlowJet jets are compared to true jets
\item[3d\_pythia\_slowjet.py] Displays Pythia events in ($\eta$,$\phi$) space, particles shown individually, SlowJet jets are colored red
%
\item[phenix\_data.py] PHENIX data plotted with error bars for charged multiplicity vs. number of participants, Au-Au at various energies
\item[phenix\_trento\_comp.py] Fits \trento\ data to PHENIX data for various Au-Au energies, charged multiplicity vs. number of participants
%
\item[pythia\_mult\_process.py] Plots frequency of charged multiplicities for various QED/QCD Pythia hard processes
\item[pythia\_pT\_process.py] Plots frequency of $p_T$ values for various QED/QCD Pythia hard processes
%
\item[scanPythia.py] Rrints SlowJet information about Pythia events such as jet constituents and jet $p_T$
\item[slowJetpT\_vs\_pTHat.py] Compares the true jet $p_T$ produced by Pythia QCD/QED events to the SlowJet jet $p_T$ 
\item[slowjet\_pTmin\_radius.py] Creates a 2d histogram for SlowJet parameters $radius$ and $p_TjetMin$ and shows average jets found for various values
\item[slowjet\_pTrange\_radius.py] Tests various values of SlowJet $radius$ while the Pythia jets are in a restricted $p_T$ range
%
\item[trento\_mult\_npart.py] Plots initial entropy (mult) vs. number of participants (Npart) for \trento\ data
\item[trento\_plot\_values.py] Creates plots for \trento\ data, such as initial entropy vs. impact parameter and number of participants vs. impact parameter, as well as others
\item[trento\_phi\_pT\_eta.py] Plots the values of $\phi$, $p_T$, and $\eta$ that are created for the \trento\ backgrounds
%
\item[xi\_slowjet.py] Creates a histogram of $\xi$ values for SlowJet jets
\item[xi\_truejet.py] Creates a histogram of $\xi$ values for true jets
\item[xi\_slowjet\_truejet.py] Compares $\xi$ for true and reconstructed jets
\end{description}


\begin{thebibliography}{10}

\bibitem{Retiere:2004hn} 
F. Retiere and M. Lisa, {\em Phys. Rev. C} 70, 044907 (2004).

\bibitem{Alver:2010do} 
B. Alver and G. Roland, {\em Phys. Rev. C} 81, (2010).

\end{thebibliography}

\end{document}